// Built at: 2025/12/15 21:53:09
var h=r=>async(t,e)=>{let s=n=>async()=>{let o=n===r.length?e:r[n];if(o)return await o(t,s(n+1))};return s(0)()};function R(r){return typeof r!="object"||r===null?String(r):r instanceof Error&&r.cause?`${r.toString()} { [cause]: ${R(r.cause)} }`:Array.isArray(r)?JSON.stringify(r):typeof r.toString=="function"&&r.toString!==Object.prototype.toString?r.toString():JSON.stringify(r)}var O=(o=>(o[o.DEBUG=1]="DEBUG",o[o.INFO=2]="INFO",o[o.WARN=3]="WARN",o[o.ERROR=4]="ERROR",o[o.OFF=5]="OFF",o))(O||{}),p=class{static level=4;static setLevel(t){this.level=Number(t)||O[t.toUpperCase()]||4}static log(...t){console.log(t.map(e=>R(e)).join(" "))}static debug(...t){this.level>1||this.log("[DEBUG]",...t)}static info(...t){this.level>2||this.log("[INFO]",...t)}static warn(...t){this.level>3||this.log("[WARN]",...t)}static error(...t){this.level>4||this.log("[ERROR]",...t)}};var f=class r{static getInstance(){return r.instance||(r.instance=r.createInstance()),r.instance}static createInstance(){if(typeof $loon<"u")return new x;if(typeof $task<"u")throw new Error("QuantumultX is not supported");return new m}static instance;request;response;argument={};state={};#t;get url(){return this.#t||(this.#t=new URL(this.request.url)),this.#t}get path(){return this.url.pathname}get method(){return this.request.method}constructor(){this.request=this.createRequest(typeof $request<"u"?$request:null),this.response=this.createResponse(typeof $response<"u"?$response:null)}getJSON(t){let e=this.getVal(t);return e?JSON.parse(e):null}setJSON(t,e){this.setVal(JSON.stringify(t),e)}exit(){$done({})}toString(){let{method:t,url:e}=this.request;return JSON.stringify({method:t,url:e})}},m=class extends f{createRequest(t){return Object.create(t,{bodyBytes:{get(){return this.body},set(e){this.body=e}}})}createResponse(t){return Object.create(t,{bodyBytes:{get(){return this.body},set(e){this.body=e}}})}initArgument(t){if(Object.assign(this.argument,t),typeof $argument=="string")try{Object.assign(this.argument,JSON.parse($argument))}catch(e){p.log(e)}}getVal(t){return $persistentStore.read(t)}setVal(t,e){return $persistentStore.write(t,e)}fetch(t){let{method:e,body:s,timeout:n=5,...o}=t;return new Promise((i,u)=>{$httpClient[e.toLowerCase()]({...o,body:s,"binary-mode":s instanceof Uint8Array,timeout:n},(a,c,d)=>{if(a)return u(a);i(this.createResponse({...c,body:d}))})})}notify(t="",e="",s="",n={}){let{openUrl:o,clipboard:i,mediaUrl:u,dismiss:a,sound:c=!0}=n,d={url:o,text:i,"media-url":u,"auto-dismiss":a,sound:c};o?d.action="open-url":i&&(d.action="clipboard"),$notification.post(t,e,s,d)}done(t){$done({...t})}abort(){$done({abort:!0})}},x=class extends m{initArgument(t){super.initArgument(t),typeof $argument=="object"&&Object.assign(this.argument,$argument)}fetch(t){return t.timeout=(t.timeout??5)*1e3,t.alpn="h2",super.fetch(t)}notify(t="",e="",s="",n={}){let{openUrl:o,mediaUrl:i,clipboard:u,delay:a}=n,c={openUrl:o,mediaUrl:i,clipboard:u};$notification.post(t,e,s,c,a)}abort(){$done()}};var y=f.getInstance();var g=class{middleware=[];use(t){return this.middleware.push(t),this}run(){h(this.middleware)(y).catch(t=>p.error(t,y)).finally(()=>y.exit())}};var l=class{path;methods;stack;constructor(t,e,s){this.path=t,this.methods=e,this.stack=s}};var S=(r,t)=>t.path===r.path,v=(r,t)=>t.request.url.endsWith(r.path);var b=class{stack=[];matchPath;constructor(t={}){this.matchPath=t.matchPath||S}use(...t){return this.register("",[],t)}get(t,...e){return this.register(t,["GET"],e)}post(t,...e){return this.register(t,["POST"],e)}routes(){return(t,e)=>{let s=this.match(t);if(!s.route)return e();let n=s.pathAndMethod.flatMap(o=>o.stack);return h(n)(t,e)}}match(t){let e={path:[],pathAndMethod:[],route:!1};for(let s of this.stack)(s.path===""||this.matchPath(s,t))&&(e.path.push(s),(s.methods.length===0||s.methods.includes(t.method))&&(e.pathAndMethod.push(s),s.methods.length>0&&(e.route=!0)));return e}register(t,e,s){if(Array.isArray(t))for(let n of t)this.stack.push(new l(n,e,s));else this.stack.push(new l(t,e,s));return this}};var P=async(r,t)=>{await t(),r.done({response:r.response})};var w=new b({matchPath:v});w.post("/getAdList",P,r=>{let t=s=>s==="0007"?'{"materialsList":[{"billMaterialsId":"1","filePath":"#","creativeType":1}],"advertParam":{"skipTime":1}}':s==="G0054"?'{"code":"00","materialsList":[{}]}':'{"code":"00","message":"0"}',e=JSON.parse(r.request.body);r.response.body=t(e.placementNo)});w.post("/mgw.htm",r=>{let t=["com.cars.otsmobile.newHomePageBussData"],e=r.request.headers,s=e["operation-type"]||e["Operation-Type"];t.includes(s)?r.abort():r.exit()});var M=w;var $=new g;$.use(M.routes());var q=$;q.run();
