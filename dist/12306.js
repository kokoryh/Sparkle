// Built at: 2025/12/14 22:26:24
var f=r=>async(t,e)=>{let o=n=>async()=>{let s=n===r.length?e:r[n];if(s)return await s(t,o(n+1))};return o(0)()};function R(r){return typeof r!="object"||r===null?String(r):r instanceof Error&&r.cause?`${r.toString()} { [cause]: ${R(r.cause)} }`:Array.isArray(r)?JSON.stringify(r):typeof r.toString=="function"&&r.toString!==Object.prototype.toString?r.toString():JSON.stringify(r)}var O=(s=>(s[s.DEBUG=1]="DEBUG",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.OFF=5]="OFF",s))(O||{}),p=class{static level=4;static setLevel(t){this.level=Number(t)||O[t.toUpperCase()]||4}static log(...t){console.log(t.map(e=>R(e)).join(" "))}static debug(...t){this.level>1||this.log("[DEBUG]",...t)}static info(...t){this.level>2||this.log("[INFO]",...t)}static warn(...t){this.level>3||this.log("[WARN]",...t)}static error(...t){this.level>4||this.log("[ERROR]",...t)}};var m=class r{static getInstance(){return r.instance||(r.instance=r.createInstance()),r.instance}static createInstance(){if(typeof $loon<"u")return new x;if(typeof $task<"u")throw new Error("QuantumultX is not supported");return new y}static instance;request;response;argument={};state={};#t;get url(){return this.#t||(this.#t=new URL(this.request.url)),this.#t}get path(){return this.url.pathname}constructor(){this.request=this.createRequest(typeof $request<"u"?$request:null),this.response=this.createResponse(typeof $response<"u"?$response:null)}getJSON(t){let e=this.getVal(t);return e?JSON.parse(e):null}setJSON(t,e){this.setVal(JSON.stringify(t),e)}exit(){$done({})}toString(){let{method:t,url:e}=this.request;return JSON.stringify({method:t,url:e})}},y=class extends m{createRequest(t){return Object.create(t,{bodyBytes:{get(){return this.body},set(e){this.body=e}}})}createResponse(t){return Object.create(t,{bodyBytes:{get(){return this.body},set(e){this.body=e}}})}initArgument(t){if(Object.assign(this.argument,t),typeof $argument=="string")try{Object.assign(this.argument,JSON.parse($argument))}catch(e){p.log(e)}}getVal(t){return $persistentStore.read(t)}setVal(t,e){return $persistentStore.write(t,e)}fetch(t){let{method:e,body:o,timeout:n=5,...s}=t;return new Promise((i,u)=>{$httpClient[e.toLowerCase()]({...s,body:o,"binary-mode":o instanceof Uint8Array,timeout:n},(a,c,d)=>{if(a)return u(a);i(this.createResponse({...c,body:d}))})})}notify(t="",e="",o="",n={}){let{openUrl:s,clipboard:i,mediaUrl:u,dismiss:a,sound:c=!0}=n,d={url:s,text:i,"media-url":u,"auto-dismiss":a,sound:c};s?d.action="open-url":i&&(d.action="clipboard"),$notification.post(t,e,o,d)}done(t){$done({...t})}abort(){$done({abort:!0})}},x=class extends y{initArgument(t){super.initArgument(t),typeof $argument=="object"&&Object.assign(this.argument,$argument)}fetch(t){return t.timeout=(t.timeout??5)*1e3,t.alpn="h2",super.fetch(t)}notify(t="",e="",o="",n={}){let{openUrl:s,mediaUrl:i,clipboard:u,delay:a}=n,c={openUrl:s,mediaUrl:i,clipboard:u};$notification.post(t,e,o,c,a)}abort(){$done()}};var h=m.getInstance();var g=class{middleware=[];use(t){return this.middleware.push(t),this}run(){f(this.middleware)(h).catch(t=>p.error(t,h)).finally(()=>h.exit())}};var l=class{path;stack;constructor(t,e){this.path=t,this.stack=e}};var M=(r,t)=>t.path===r.path,v=(r,t)=>t.request.url.endsWith(r.path);var b=class{stack=[];matchPath;constructor(t={}){this.matchPath=t.matchPath||M}use(...t){return this.register("",t)}add(t,...e){return this.register(t,e)}routes(){return(t,e)=>{let o=this.match(t);if(o.length===0)return e();let n=o.flatMap(s=>s.stack);return f(n)(t,e)}}match(t){return this.stack.filter(e=>e.path===""||this.matchPath(e,t))}register(t,e){if(Array.isArray(t))for(let o of t)this.stack.push(new l(o,e));else this.stack.push(new l(t,e));return this}};var P=async(r,t)=>{await t(),r.done({response:r.response})};var w=new b({matchPath:v});w.add("/getAdList",P,r=>{let t=o=>o==="0007"?'{"materialsList":[{"billMaterialsId":"1","filePath":"#","creativeType":1}],"advertParam":{"skipTime":1}}':o==="G0054"?'{"code":"00","materialsList":[{}]}':'{"code":"00","message":"0"}',e=JSON.parse(r.request.body);r.response.body=t(e.placementNo)});w.add("/mgw.htm",r=>{let t=["com.cars.otsmobile.newHomePageBussData"],e=r.request.headers,o=e["operation-type"]||e["Operation-Type"];t.includes(o)?r.abort():r.exit()});var $=w;var q=new g;q.use($.routes());var S=q;S.run();
