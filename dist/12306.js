// Built at: 2025/11/23 15:20:31
var f=r=>async(e,t)=>{let s=o=>async()=>{let n=o===r.length?t:r[o];if(n)return await n(e,s(o+1))};return s(0)()};function x(r){return typeof r!="object"||r===null?String(r):r instanceof Date?r.toISOString():r instanceof RegExp?r.toString():Array.isArray(r)?JSON.stringify(r):typeof r.toString=="function"&&r.toString!==Object.prototype.toString?r.toString():JSON.stringify(r)}var d=class r{static getInstance(){if(!r.instance){let e="Surge";if(typeof $loon<"u")e="Loon";else if(typeof $task<"u")throw new Error("QuantumultX is not supported");r.instance=r.classNames[e]()}return r.instance}static classNames={Surge:()=>new g,Loon:()=>new m};static instance;req=Object.create(null);res=Object.create(null);request=Object.create(null);response=Object.create(null);argument=Object.create(null);state=Object.create(null);logLevels={debug:1,info:2,warn:3,error:4,off:5};logLevel=this.logLevels.error;_url;get url(){return this._url||(this._url=new URL(this.request.url)),this._url}get method(){return this.request.method}get path(){return this.url.pathname}constructor(){typeof $request<"u"&&(this.req=$request,this.request=this.createRequest($request)),typeof $response<"u"&&(this.res=$response,this.response=this.createResponse($response))}getJSON(e){let t=this.getVal(e);return t?JSON.parse(t):null}setJSON(e,t){this.setVal(JSON.stringify(e),t)}logWithPrefix(e,t){console.log(`${e}${t.map(s=>x(s)).join(" | ")}`)}log(...e){this.logWithPrefix("",e)}debug(...e){this.logLevel>this.logLevels.debug||this.logWithPrefix("[DEBUG]",e)}info(...e){this.logLevel>this.logLevels.info||this.logWithPrefix("[INFO]",e)}warn(...e){this.logLevel>this.logLevels.warn||this.logWithPrefix("[WARN]",e)}error(...e){this.logLevel>this.logLevels.error||this.logWithPrefix("[ERROR]",e)}exit(){$done({})}},g=class extends d{createRequest(e){return Object.create(e,{bodyBytes:{get(){return this.body},set(t){this.body=t}}})}createResponse(e){return Object.create(e,{bodyBytes:{get(){return this.body},set(t){this.body=t}}})}createArgument(e){typeof $argument=="string"&&(this.argument=Object.assign(e,JSON.parse($argument)),"logLevel"in this.argument&&(this.logLevel=this.logLevels[this.argument.logLevel]??this.logLevels.error))}getVal(e){return $persistentStore.read(e)}setVal(e,t){return $persistentStore.write(e,t)}fetch(e){let{method:t,body:s,timeout:o=5,...n}=e;return new Promise((i,p)=>{$httpClient[t.toLowerCase()]({...n,body:s,"binary-mode":s instanceof Uint8Array,timeout:o},(a,u,c)=>{if(a)return p(a);i(this.createResponse({...u,body:c}))})})}notify(e="",t="",s="",o={}){let{openUrl:n,clipboard:i,mediaUrl:p,dismiss:a,sound:u=!0}=o,c={url:n,text:i,"media-url":p,"auto-dismiss":a,sound:u};n?c.action="open-url":i&&(c.action="clipboard"),$notification.post(e,t,s,c)}ungzip(e){return $utils.ungzip(e)}done(e){e={...e},"response"in e&&(e.response={...e.response}),$done(e)}abort(){$done({abort:!0})}},m=class extends g{createArgument(e){super.createArgument(e),typeof $argument=="object"&&(this.argument=Object.assign(e,$argument),"logLevel"in this.argument&&(this.logLevel=this.logLevels[this.argument.logLevel]??this.logLevels.error))}fetch(e){return e.alpn="h2",e.timeout=(e.timeout??5)*1e3,super.fetch(e)}notify(e="",t="",s="",o={}){let{openUrl:n,mediaUrl:i,clipboard:p,delay:a}=o,u={openUrl:n,mediaUrl:i,clipboard:p};$notification.post(e,t,s,u,a)}abort(){$done()}};var y=class{middleware=[];use(e){return this.middleware.push(e),this}run(){let e=d.getInstance();f(this.middleware)(e).catch(t=>e.error(t)).finally(()=>e.exit())}};var l=class{path;stack;constructor(e,t){this.path=e,this.stack=t}};var h=class{stack=[];matchPath;constructor(e={}){this.matchPath=e.matchPath||((t,s)=>t.path===s.path)}use(...e){return this.register("",e)}add(e,...t){return this.register(e,t)}routes(){return(e,t)=>{let s=this.match(e);if(s.length===0)return t();let o=s.flatMap(n=>n.stack);return f(o)(e,t)}}match(e){return this.stack.filter(t=>t.path===""||this.matchPath(t,e))}register(e,t){if(Array.isArray(e))for(let s of e)this.stack.push(new l(s,t));else this.stack.push(new l(e,t));return this}};var R=async(r,e)=>{await e(),r.done({response:r.response})};var b=new h({matchPath:(r,e)=>e.request.url.endsWith(r.path)});b.add("/getAdList",R,r=>{let e=s=>s==="0007"?'{"materialsList":[{"billMaterialsId":"1","filePath":"#","creativeType":1}],"advertParam":{"skipTime":1}}':s==="G0054"?'{"code":"00","materialsList":[{}]}':'{"code":"00","message":"0"}',t=JSON.parse(r.request.body);r.response.body=e(t.placementNo)});b.add("/mgw.htm",r=>{let e=["com.cars.otsmobile.newHomePageBussData"],t=r.request.headers,s=t["operation-type"]??t["Operation-Type"];e.includes(s)?r.abort():r.exit()});var v=b;var w=new y;w.use(v.routes());var O=w;O.run();
